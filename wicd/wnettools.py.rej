--- wicd/wnettools.py	2012-07-20 11:22:22.113803306 -0300
+++ wicd/wnettools.py	2012-07-20 11:22:37.625802655 -0300
@@ -285,22 +285,22 @@
         
         client_dict = {
             "dhclient" : 
-                {'connect' : r"%(cmd)s -cf %(dhclientconf)s %(iface)s",
+                {'connect' : r"%(cmd)s -cf %(dhclientconf)s %(extra)s %(iface)s",
                  'release' : r"%(cmd)s -r %(iface)s",
                  'id' : misc.DHCLIENT, 
                  },
             "pump" : 
-                { 'connect' : r"%(cmd)s -i %(iface)s -h %(hostname)s",
+                { 'connect' : r"%(cmd)s -i %(iface)s -h %(hostname)s %(extra)s",
                   'release' : r"%(cmd)s -r -i %(iface)s",
                   'id' : misc.PUMP,
                 },
             "dhcpcd" : 
-                {'connect' : r"%(cmd)s -h %(hostname)s --noipv4ll %(iface)s ",
+                {'connect' : r"%(cmd)s -h %(hostname)s --noipv4ll %(extra)s %(iface)s",
                  'release' : r"%(cmd)s -k %(iface)s",
                  'id' : misc.DHCPCD,
                 },
             "udhcpc":
-                {'connect' : r"%(cmd)s -n -i %(iface)s -H %(hostname)s ",
+                {'connect' : r"%(cmd)s -n -i %(iface)s -H %(hostname)s %(extra)s",
                  'release' : r"killall -SIGUSR2 %(cmd)s",
                  'id' : misc.UDHCPC,
                 },
@@ -335,13 +335,21 @@
             return ""
             
         if flavor == "connect":
+            extra = ""
             if not hostname:
                 hostname = os.uname()[1]
-            return client_dict[client_name]['connect'] % \
+
+            # set up extra commands to the dhcp client
+            if staticdns and client_name == "dhcpcd":
+                extra = "--nohook resolv.conf"
+                
+            return client_dict[client_name][flavor] % \
                     { "cmd" : cmd,
                       "iface" : self.iface,
                       "hostname" : hostname,
-                      'dhclientconf' : dhclient_conf_path }
+                      'dhclientconf' : dhclient_conf_path,
+                      'extra': extra
+                    }
         elif flavor == "release":
             return client_dict[client_name]['release'] % {"cmd":cmd, "iface":self.iface}
         else:
@@ -603,7 +611,7 @@
         _check_dhcp_result for the possible values.
         
         """
-        cmd = self._get_dhcp_command('connect', hostname)
+        cmd = self._get_dhcp_command('connect', hostname, staticdns)
         if self.verbose: print cmd
         self.dhcp_object = misc.Run(cmd, include_stderr=True, return_obj=True)
         pipe = self.dhcp_object.stdout
