commit 6b42a20e70fbba3f24d21ecdc29014337527127d
Author: martin f. krafft <madduck@debian.org>
Date:   Sat Jan 2 12:58:49 2010 +1300

    Ensure target locations exists before writing template files
    
    scripts/wicd-client could not be written since scripts/ didn't exist.
    This patch creates directories as needed, and also attempts to remove
    emmpty directories on clean.
    
    WARNING: it seems that the cleangenerated class is never called though.
    
    Signed-off-by: martin f. krafft <madduck@debian.org>

diff --git a/setup.py b/setup.py
index b305c40..de95d63 100644
--- a/setup.py
+++ b/setup.py
@@ -324,6 +324,10 @@ class configure(Command):
                 original_name = os.path.join('in',item)
                 item_in = open(original_name, 'r')
                 final_name = item[:-3].replace('=','/')
+                parent_dir = os.path.dirname(final_name)
+                if len(parent_dir) > 0 and not os.path.exists(parent_dir):
+                    print '(mkdir %s)'%parent_dir,
+                    os.makedirs(parent_dir)
                 print final_name
                 item_out = open(final_name, 'w')
                 for line in item_in.readlines():
@@ -363,6 +367,7 @@ class clear_generated(Command):
                 print final_name, '...',
                 if os.path.exists(final_name):
                     os.remove(final_name)
+                    os.removedirs(os.path.dirname(final_name))
                     print 'Removed.'
                 else:
                     print 'Does not exist.'
