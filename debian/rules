#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

include /usr/share/quilt/quilt.make

configure: configure-stamp
configure-stamp: $(QUILT_STAMPFN)
	dh_testdir
	
	python setup.py configure \
		--no-install-docs
	
	touch $@

build: build-stamp
build-stamp: configure-stamp
	dh_testdir

	python setup.py build

	touch $@

clean: unpatch
	dh_testdir
	dh_testroot

	python setup.py clean
	
	find . \( -name "*.pyc" -o -name "*.pyo" \) -exec rm -rf {} \;
	find ./init/ \( -name "wicd" -o -name "rc.wicd" \) -exec rm -rf {} \;
	-rm -rf build/

	dh_clean build-stamp configure-stamp \
		wpath.py install.log os wicd/wpath.py \
		man/*.8 man/*.5 scripts/* other/*.sh \
		other/postinst

install: build
	dh_testdir
	dh_testroot
	dh_clean -k 
	dh_installdirs

	python setup.py install --root=$(CURDIR)/debian/wicd
	install -m644 debian/wicd-client.xpm \
		$(CURDIR)/debian/wicd/usr/share/pixmaps/wicd.xpm

binary-arch: build install
binary-indep: build install
	dh_testdir
	dh_testroot
	dh_installchangelogs CHANGES
	dh_installdocs
	dh_installexamples
	dh_installmenu
	dh_installinit
	dh_installman
	dh_link
	dh_strip
	dh_compress
	dh_pysupport
	dh_fixperms
	dh_installdeb
	dh_gencontrol
	dh_md5sums
	dh_builddeb

binary: binary-indep binary-arch
.PHONY: build clean binary-indep binary-arch binary install
